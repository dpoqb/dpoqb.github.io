[{"title":"“2020年中国高校计算机大赛·华为云大数据挑战赛-正赛”","date":"2020-07-10T15:46:56.000Z","url":"/2020/07/10/%E2%80%9C2020%E5%B9%B4%E4%B8%AD%E5%9B%BD%E9%AB%98%E6%A0%A1%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%A4%A7%E8%B5%9B%C2%B7%E5%8D%8E%E4%B8%BA%E4%BA%91%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8C%91%E6%88%98%E8%B5%9B-%E6%AD%A3%E8%B5%9B%E2%80%9D/","tags":["Contends"],"content":" 赛题链接： 本文记录我的比赛过程、经验以及遇到的问题 1 背景在企业全球化业务体系中，海运物流作为其最重要的一项支撑。其中，船运公司会和数据供应公司进行合作，对运输用的船通过GPS进行定位以监控船的位置；在运输管理的过程中，货物到达目的港的时间是非常重要的一项数据，那么需要通过船运的历史数据构建模型，对目的港到达时间进行预测，预测时间简称为ETA（estimated time of arrival），目的港到达时间预测为ARRIVAL_ETA。 2 赛题分析2.1 数据大赛提供脱敏后的训练数据及测试数据，训练数据集包括：历史运单GPS数据、历史运单事件数据、港口坐标数据，这些数据主要用于参赛队伍训练模型，制定预估策略；测试运单数据为不同运单、运输过程中的不同位置所构成，供选手测试对应的ETA时间。 货物运单在船运过程中，会产生大量的GPS运单数据，记录为“历史运单GPS数据”；货物运单在船运过程中离开起运港、到达中转港、到达目的港等关键事件，记录为“历史运单事件数据”；“港口的坐标数据“为与运单船运相关的港口坐标信息。 允许选手合理增加与题目相关的外部数据进行纠正，如大赛提供的港口坐标数据存在偏差时可自行补充数据纠正。 下面为各数据集文件的基本信息： 名称 文件名 格式 size 历史运单GPS数据 train0523 .rar 1.04 GB 历史运单事件数据 loadingOrderEvent .csv 14.3 MB 港口坐标数据 port .csv 280 kB 测试运单数据 A_testData0531 .csv 5.53 MB 2.1.1 历史运单GPS数据（重要）本赛提供了2019年1月到2020年4月的GPS数据，历史运单GPS数据描述每个运单在船运的过程中，所在船产生的GPS位置的相关信息。 列名 类型 说明 0 loadingOrder VARCHAR2 脱敏后的主运单，货物的运单编号，类似快递单号 1 carrierName VARCHAR2 脱敏后的承运商名称，类似快递公司名称 2 timestamp DATE 时间，格式为：yyyy-MM-dd’T’HH:mm:ss.SSSZ，如2019-09-05T16:33:17.000Z 这种格式的时间是UTC通用标准时间，UTC即为世界标准时间，世界统一时间，国际协调时间，字母T是时间和日期的分隔符，T后面表示的即为时间，末尾的z表示UTC统一时间。  3 longitude NUMBER 货物在运输过程中，当前船舶所处的经度坐标，如114.234567 4 latitude NUMBER 货物在运输过程中，当前船舶所处的纬度坐标，如21.234567 5 vesselMMSI VARCHAR2 脱敏后的船舶海上移动业务识别码MMSI， 唯一标识，对应到每一艘船 6 speed NUMBER 单位km/h，货物在运输过程中，当前船舶的瞬时速度，部分数据未提供的可自行计算。 7 direction NUMBER 当前船舶的行驶方向，正北是0度，31480代表西北方向314.80度，900代表正北偏东9度。 8 vesselNextport VARCHAR2 船舶将要到达的下一港口，港口名称可能不规范，如CNQIN、CN QIN、CN QINGDAO都代表下一站为中国青岛港口。 9 vesselNextportETA DATE 船运公司给出的到“下一个港口”预计到达时间，格式为：yyyy-MM-dd’T’HH:mm:ss.SSSZ，如2019-09-12T16:33:17.000Z 10 vesselStatus VARCHAR2 当前船舶航行状态，主要包括： moored（停泊） under way using engine（在使用发动机） not under command（失控） at anchor（抛锚） under way sailing（在航行） constrained by her draught（吃水受限） 11 vesselDatasource VARCHAR2 船舶数据来源（岸基/卫星）：Coastal AIS，Satellite 12 TRANSPORT_TRACE VARCHAR2 船的路由，由“-”连接组成，例如CNSHK-MYPKG-MYTPP。由承运商预先录入，实际小概率存在不按此路由行驶（如遇塞港时），但最终会到达目的港口。 每个运单表示一次运输的运输单号，不会重复使用，一次运输过程中的多条GPS数据拥有相同的运输单号。船号为运单货物所在的船编号，会重复出现在不同次运输的GPS数据中，当然也有可能存在多个货物同时存在于一艘货船上的情况。 GPS数据可能存在的异常： （1） GPS坐标在陆地，或者有些港口是内陆的港口 （2） GPS漂移：两点距离过大，超过船的行驶能力 （3） GPS在部分地区的比较稀疏（比如南半球、敏感海域） （4） 最后的GPS点可能和港口的距离较远（比如塞港时，或者临近目的港时已无GPS数据） （5） speed字段之后数据可能会有少量缺失（如GPS设备短暂异常） GPS数据还可能存在的问题： 部分运单只包含航线始发港附近的部分GPS数据 一条订单中可能存在时间、经纬度完全相同的记录 有些订单号数量只有几条 GPS数据只有航线中间一段，远离起始点和终点 2.1.2 历史运单事件数据历史运单事件数据描述每个运单在船运的过程中，与港口相关的关键信息，如离开起运港、到达目的港等。 列名 类型 说明 loadingOrder VARCHAR2 运单号，与历史运单GPS数据中的loadingOrder字段一致 EVENT_CODE VARCHAR2 事件编码，主要事件包括： TRANSIT PORT ATD实际离开中转港 SHIPMENT ONBOARD DATE实际离开起运港 TRANSIT PORT ATA实际到达中转港 ARRIVAL AT PORT实际到达目的港 注：部分船可能没有中转港 EVENT_LOCATION_ID VARCHAR2 港口名称，对应“港口坐标数据”表中的字段TRANS_NODE_NAME EVENT_CONVOLUTION_DATE DATE 事件发生的时间，格式为：yyyy/MM/dd HH:mm:ss（dd与HH之间为两个空格）。 例如Event_code为“SHIPMENT ONBOARD DATE”时，此字段表示船从起运港出发的时间。 EVENT_CODE为“ARRIVAL AT PORT”时，此字段表示船到达目的港的时间。 2.1.3 港口坐标数据港口坐标数据描述每个运单在船运的过程中涉及的港口位置信息。 列名 类型 说明 TRANS_NODE_NAME VARCHAR2 港口名称，如：WAREHOUSE_TURKEY，MOSCOW_RUSSIAN FEDERATION， CHIWAN(44)，SHEKOU，深圳蛇口港等 LONGITUDE VARCHAR2 港口的经度坐标 LATITUDE VARCHAR2 港口的纬度坐标 COUNTRY VARCHAR2 国家 STATE VARCHAR2 省|州 CITY VARCHAR2 城市 REGION VARCHAR2 县|区 ADDRESS VARCHAR2 详细地址。 PORT_CODE VARCHAR2 港口编码，即港口的字母简码，如CNSHK代表中国蛇口港 2.1.4 测试运单数据测试运单数据为运单运输过程中的不同位置点所构成，供选手测试对应的ETA时间。测试运单数据如下表描述。 列名 类型 说明 loadingOrder VARCHAR2 运单的运单号 timestamp DATE 运单当前所处位置（经度、维度）的时间，格式为：yyyy-MM-dd’T’HH:mm:ss.SSSZ，如2019-09-05T16:33:17.000Z longitude VARCHAR2 运单承运船舶的当前经度：114.234567 latitude VARCHAR2 运单承运船舶的当前纬度：21.234567 speed NUMBER 货物在运输过程中，当前船舶的瞬时速度，部分数据未提供的可自行计算。 direction NUMBER 当前船舶的行驶方向，正北是0度，31480代表西北方向314.80度，900代表正东偏南9度。 carrierName VARCHAR2 承运商名称，类似快递公司名称 vesselMMSI VARCHAR2 脱敏后的船舶海上移动业务识别码MMSI， 唯一标识，对应到每一艘船 onboardDate DATE 离开起运港时间，格式为：yyyy/MM/dd HH:mm:ss（dd与HH之间为两个空格），如2019/09/05 16:33:17 TRANSPORT_TRACE VARCHAR2 船的路由，由“-”连接组成，例如CNSHK-MYPKG-MYTPP。由承运商预先录入，实际小概率存在不按此路由行驶（如遇塞港时），但最终会到达目的港口。 测试集只包含一部分航线前一部分GPS数据，当然实际业务中也不可能给你一个将要到达目的港的货船让你预测达到时间。 2.2 提交结果提交结果数据，具体提交格式要求： 列名 类型 示例 loadingOrder VARCHAR2 测评提交的test运单号 timestamp DATE 运单当前所处位置（经度、维度）的时间，格式为：yyyy-MM-dd’T’HH:mm:ss.SSSZ，如2019-09-05T16:33:17.000Z longitude NUMBER 运单承运船舶的当前经度：114.234567 latitude NUMBER 运单承运船舶的当前纬度：21.234567 carrierName VARCHAR2 承运商名称，类似快递公司名称 vesselMMSI VARCHAR2 脱敏后的船舶海上移动业务识别码MMSI， 唯一标识，对应到每一艘船 onboardDate DATE 离开起运港时间，格式为：yyyy/MM/dd HH:mm:ss（dd与HH之间为两个空格），如2019/09/05 16:33:17 ETA DATE 到达目的港口的ETA，格式为：yyyy/MM/dd HH:mm:ss（dd与HH之间为两个空格），如2019/09/18 22:28:46 creatDate DATE 当前表创建时间，格式为：yyyy/MM/dd HH:mm:ss（dd与HH之间为两个空格），如2020/05/05 16:33:17 其中，ETA为选手评估的时间值；creatDate为该表或该CSV文件创建时间，用于区别多次提交数据。对于未提交的运单ETA，后台统一取timestamp时间计算。 2.3 评估标准选手提交结果的评估指标是MSE，即ARRIVAL AT PORT预测时间ETA与真实时间ATA的差距的平方和，计算如下： 其中： （1） hETA为同一个货物运单到达目的港口的预测所需时间。选手提供DATE时间，评测程序转换为单位所需时间，单位：小时。 （2） hATA为同一个货物运单到达目的港口的实际所需时间，大赛测评程序后台保存，用于测评运算。 （3） ETA_NUM为预测的ETA数量，测评程序后台运算，大赛测评程序后台保存，用于测评运算。 最终使用MSE值作为参赛选手得分，MSE值越小，排名越靠前。 3 初赛A3.1 数据探索3.1.1 历史运单GPS数据基本信息统计历史运单GPS数据数据解压之后的csv文件的size有21.5G，所以对于一般的内存是不够的，我首先选用华为云ModelArts免费的计算资源（GPU: 1*p100 CPU: 8 核 64GiB）进行数据探索。将数据压缩成zip格式后上传到OBS桶中，然后再拷贝到notebook实例本地。 历史运单GPS数据缺失值统计 pandas使用chunksize分块处理大型csv文件。 输出结果： 每个运单数据量 观察每个运单数据量可以发现有的运单数据量非常小（有的只有个位数） 历史运单GPS数据运单数 实现方法与之前类似，最后统计结果为21157个运单 统计船、承运商，并统计每艘船在此期间运送的运单数 carrierName vesselMMSI loadingOrder_num 0 ATREQJ E5476692249 1 1 ATREQJ E8843077070 12 2 ATREQJ G5274775980 8 3 ATREQJ J2600017167 8 4 ATREQJ M7570035089 1 5 ATREQJ N6018343625 5 6 ATREQJ N7662870838 2 7 ATREQJ O3706742805 7 8 ATREQJ P7459866102 1 9 ATREQJ Q9879653504 9 10 ATREQJ V1643841644 8 11 ATREQJ X2571110231 2 12 ATREQJ Z6382267883 6 13 BHSOUA A1526532910 1 14 BHSOUA A3033852636 1 15 BHSOUA A3106939560 5 16 BHSOUA B1967879094 1 17 BHSOUA B2174768126 4 18 BHSOUA B4195200696 1 19 BHSOUA B5481611330 2 20 BHSOUA B8602523000 1 21 BHSOUA B9240070902 8 22 BHSOUA B9483539253 1 23 BHSOUA C1642772456 1 24 BHSOUA C1843774842 1 25 BHSOUA C2347388710 2 26 BHSOUA C2602086954 4 27 BHSOUA C2740363303 8 28 BHSOUA C3134805549 1 29 BHSOUA C3576936112 1 … … … … 3417 YNTVVL D4737359369 5 3418 YNTVVL E1183558223 3 3419 YNTVVL E2886252395 7 3420 YNTVVL E8438546418 4 3421 YNTVVL H2003929218 1 3422 YNTVVL H2343802217 1 3423 YNTVVL H8990822892 2 3424 YNTVVL I5301015393 3 3425 YNTVVL I6917049729 1 3426 YNTVVL I8418883342 4 3427 YNTVVL J1221393739 1 3428 YNTVVL J7065476536 1 3429 YNTVVL K2689843740 4 3430 YNTVVL K2833336903 2 3431 YNTVVL L2005995468 1 3432 YNTVVL L4408137439 1 3433 YNTVVL M5266979228 3 3434 YNTVVL N5230316561 3 3435 YNTVVL N9433767762 1 3436 YNTVVL O2359343197 1 3437 YNTVVL Q4546304622 8 3438 YNTVVL S1479644926 6 3439 YNTVVL S8103727537 3 3440 YNTVVL T4057606472 4 3441 YNTVVL T7110391183 1 3442 YNTVVL U1911179453 1 3443 YNTVVL W2722004813 5 3444 YNTVVL W4243547329 3 3445 YNTVVL X6159374629 1 3446 YNTVVL Y5115940482 9 统计每家承运商在此期间运输运单数 carrierName loadingOrder_num 0 ATREQJ 70 1 BHSOUA 722 2 EHGYJK 137 3 ENSBXC 31 4 FGPEPT 482 5 FXAJBJ 15 6 HMKTVZ 219 7 IEXJUL 8 8 JCMFTA 3541 9 JONOCD 2444 10 KJIHXD 494 11 NWLGLX 568 12 OIEQNT 4622 13 OQTZLW 192 14 OYSCFP 4032 15 PBTMHU 3 16 RFRFUU 545 17 RMZCAZ 39 18 RWHZVZ 3350 19 UCQOQO 528 20 UQCRKD 343 21 USCDYK 506 22 VFUZBJ 163 23 VMUSFS 210 24 VRFMKJ 463 25 WGITMV 1 26 XONUPN 45 27 YAAWEN 298 28 YNTVVL 100 统计使用相同路由的运单数 TRANSPORT_TRACE存在类似于149000158291这样数字以及单个港口名称的路由，不符合路由规范的可以考虑剔除掉。 TRANSPORT_TRACE order_cnt 0 149000158291 1 1 149000340170 1 2 149904718645 1 3 149904720615 1 4 581431100 1 5 581462811 1 6 582650127 1 7 582935541 1 8 583109208 1 9 583593671 1 10 583880985 1 11 584664940 1 12 585371461 1 13 585591774 1 14 586517605 1 15 588431610 1 16 589241091 1 17 AAR-HKG 1 18 AEJEA-CIABJ-FALADIE 5 19 AEJEA-HKHKG 3 20 AEJEA-MAPTM-CIABJ 1 21 AEJEA-MAPTM-MRNOU 1 22 AEJEA-MTMLA-DZALG 1 23 AEJEA-SAJED-MTMLA-DZALG 1 24 AEJEA-SGSIN-CNHKG 1 25 AEJEA-SNDKR-KATI 1 26 AEJEA-ZADUR-MBABANE 1 27 ALGIERS PORT_ALGERIA 2 28 AQABA-HONGKONG 1 29 AQABA-PORT KLANG_MALAYSIA-HONGKONG 1 … … … 1008 THBKK-HKHKG 5 1009 TNTUN-MATNG-HKHKG 1 1010 TORONTO_CANADA 1 1011 UAILK-OMSLL 2 1012 UAILK-OMSLL-HONG KONG 1 1013 UAODS-MYPKG-HONG KONG 1 1014 UMM QASR 1 1015 VELAG-HKHKG 2 1016 YANTIAN-COLON CONTAINER TERMINAL-COLON FREE TR… 5 1017 YANTIAN-MALTA 1 1018 YANTIAN-MALTA-TRIPOLI 3 1019 YANTIAN-MANAUS 2 1020 YANTIAN-MANAUS-MANZANILLO_PANAMA 1 1021 YANTIAN-MANZANILLO_PANAMA 1 1022 YANTIAN-MANZANILLO_PANAMA-MANAUS 17 1023 YANTIAN-MELBOURNE 4 1024 YANTIAN-ROTTERDAM_NETHERLANDS-REYKJAVIK 1 1025 YANTIAN-SAN JOSE 1 1026 YANTIAN-SAN JOSE-CRLIO 1 1027 YANTIAN-VLADIVOSTOK 2 1028 YANTIAN-minsk 1 1029 YMLUR309014704 1 1030 YMLUZ309169482 1 1031 YTLON 2 1032 YTN-KOP 1 1033 YTN-RJK 1 1034 YTN-RTM 6 1035 YTN-VAN 1 1036 ZADUR-HKHKG 13 1037 ZIMUSHH301826923 1 3.1.2 测试集数据基本信息统计 统计测试集不同路由、货船运输每个运单的数据量（部分） 测试集每个运单的数据量分布具有随机性。由于训练集和测试集每条航线数据量分布不一致，需要考虑对训练集的数据每个运单数据按照某种方法截取一部分。 测试集所有路由及运单数 测试集总共有222个运单，但是最后需要提交4万多条数据（一个运单包含多条GPS数据），每个运单的数据量不一样。这实际上是评价函数的一种加权方式，根据MSE公式，可以发现GPS序列越多的运单权重越大，我们将MSE公式形式进行一个改写： $MSE=\\frac {\\sum_{i=1}^{ETA_NUM}Weight_i(hETA_i-hATA_i)^2}{\\sum_{i=1}^{ETA_NUM}Weight_i}$ TRANSPORT_TRACE loadingOrder 0 CNHKG-MXZLO 1 1 CNSHA-PAMIT 1 2 CNSHA-SGSIN 1 3 CNSHK-CLVAP 20 4 CNSHK-ESALG 1 5 CNSHK-GRPIR 4 6 CNSHK-LBBEY 1 7 CNSHK-MYTPP 17 8 CNSHK-PKQCT 2 9 CNSHK-SGSIN 13 10 CNSHK-SIKOP 4 11 CNSHK-ZADUR 3 12 CNYTN-ARENA 10 13 CNYTN-CAVAN 4 14 CNYTN-MATNG 14 15 CNYTN-MTMLA 1 16 CNYTN-MXZLO 88 17 CNYTN-NZAKL 2 18 CNYTN-PAONX 30 19 CNYTN-RTM 3 20 COBUN-HKHKG 1 21 HKHKG-FRFOS 1 测试集时间跨度 测试集时间跨度为2019-01-10 00:27:58+00:00 -- 2020-03-27 00:10:08+00:00，基本和训练集时间跨度一致，没有历史区间可供利用。因此，该任务类型不是历史预测未来的问题（例如，根据历史数据预测未来15天用户优惠券使用概率、根据春节之前车流量数据预测春节后车流量），而是单一序列问题。 3.1.3 观察训练集数据 观察一个训练集某个运单的GPS数据 先读取一个运单的数据观察一下它的航线是什么样的 上图的航线图还比较完整，但是也存在一些航线不完整的运单，比如下图航线起始点与深圳的始发港距离较远，类似可以推测出还存在其他GPS数据不完整的运单。 观察同一路由的所有运单的GPS数据 下面再读取路由为CNYTN-MXZLO下所有运单的数据观察一下它们的航线的起点和终点。我将起点和终点的异常点分别用红色和黑色笔标出，可以发现同一路由不同运单起点和终点与起始港和目的港存在偏差，所以我们应该尽量选取偏差较小的运单数据。 由于在实际业务中，所给的训练集或者测试集航线不一定都是从始发港开始的，所以起点与初始港口偏离较大的需要分情况考虑，如果训练集需要从起始点开始计算总的航行时间，则需要尽量选用偏离较小的航线。 观察训练集到港时的数据 对船的速度和坐标点进行可视化，绿色越深表示速度越小（最小为0）。 数据可视化：杨新瑞 下面我选取两个相同路由的运单数据，对整个航行过程中的速度变化绘制成曲线 上图船没有发生塞港，在到港时速度会很快减小到0，这类数据比较容易处理。 但有的末尾速度在降低过程存在波动，很有可能是由于塞港导致的，所以在预处理过程需要注意。 3.1.4 观察测试集数据我们队对测试集所有运单进行了观察，总结出测试集数据存在以下几种情况 测试集中存在订单到达目的港后还继续前进 测试集中存在订单并不是从初始港开始截取 测试集中的订单路由都没有中转港但仍然有靠港停泊的情况 有些订单GPS数据一直在走但是速度几乎为0 3.1.5 观察训练集和测试集数据密集程度将从训练集中随机抽取的222个运单和测试集运单分组并计算平均时间间隔（单位：min），可以看出训练集时间间隔明显低于测试集，说明训练集GPS数据比测试集更密集。 3.1.6 其他探索根据官方资料提示，历史运单还存在两点距离过大，超过船的行驶能力（这里我理解的意思是两点时间间隔过小而距离又过大），除此之外，还可能存在出发前或者到港靠港后仍然在采集GPS数据的情况之类等等，可以尝试找到这些情况。 3.2 数据预处理、打标我的第一个方案是打算把一个运单作为一个样本进行预测，因此训练集样本打标方式采用的是$label = timestamp_{max} - timestamp_{min}$，这种打标方式要求timestamp的最大最小值尽可能真实，对于第一个点和最后一个点（按时间排序）与起点和终点的偏离太大的运单会导致label不准确。 训练集预处理主要按一下几个步骤： 去除重复数据：有的运单数据存在timestamp相同的记录 去除路由为空或者不合法的运单 去除和始发港、目的港口偏离较大的运单、GPS数据量较少的运单 去除出港之前产生的冗余数据：即从第一个点开始去除速度为0的点只保留一个 去除发生阻塞之后的数据：发生阻塞时可能会在港口之外停留较长时间，这里通过在设定目的港距离阈值范围内， 把速度小于某个值之后的数据去除掉以实现目的 经过预处理后训练集运单数还剩下8029条。 测试集预处理按一下几个步骤： 去除出港之前产生的冗余数据：即从第一个点开始去除速度为0的点只保留一个 去除测试集中时间间隔为0的数据 对到港之后仍然有GPS记录的数据进行去除 最后测试集$ETA=onboardDate+label$ 3.3 下采样==经过打标之后再进行采样==，采样主要有两个任务，一是截取训练集航线一部分，二是对训练集数据进行稀疏处理，目的是为了保持训练集和测试集数据的一致性。 任务一主要按距离进行截取： 计算起点与终点的直线距离以及每一个GPS点到起点的直线距离，然后分别以总距的{0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7}比例计算到起点的最大距离，从而截取航线前一部分数据 我设置了一组比例{0.1, 0.2, 0.3, 0.4, 0.5}，然后组合成一对比例{s0, s1}，其中s0&lt;s1，按s0和s1分别计算到起点距离的下限和上限，从而截取航线中间部分数据 任务二主要按固定时间间隔进行稀疏处理 任务一和任务二按不同比例获得的新运单数据将还不能直接append到训练集中，需要在提取特征之后加入到训练集中，最后训练时并不考虑loadingOrder之类的列，而我们的训练集运单数量由此得到扩充。 以上方法并不是最好的方法，还需要多做一些尝试和创新。 3.4 特征工程特征工程并没有做太多，主要与速度、距离相关，我分别以承运商、货船ID为索引提取一些速度统计特征，然后参照port.csv港口表（港口表有的数据经纬度存在问题需要进行数据清洗，这里不再赘述）计算了始发港和目的港的直线距离，提取了距离特征，最后以运单ID为索引提取了速度特征和方位角特征。 3.5 模型训练模型训练主要采用LightGBM算法+五折交叉验证的方法 预测结果将按loadingOrder合并到提交数据中，同一个运单不同GPS数据将采用同一个预测结果，最后线上提交结果评估分数为1728。 4 初赛B初赛B阶段会采用新的测试集，主要是检测模型泛化能力，以及防止有人利用技巧进行成绩提升，因为这种做法并不符合大赛的定位和目的，即面向企业真实场景和实际数据的算法竞赛。 4.1 数据探索通过对新的测试集进行观察，我们发现测试集有以下几种情况： 测试集中存在订单到达目的港后还继续前进 测试集中存在订单并不是从初始港开始截取 测试集中的订单路由都没有中转港但仍然有靠港停泊的情况 测试集中只有起始港附近几个点、速度几乎全为0 首先采用与初赛A类似的预处理方法，但需要主要不要把测试集速度全为0的运单丢失了，然后用初赛A训练的模型预测初赛B测试集，线上提交分数为1800左右，这个模型似乎并不是特别理想。经过多次尝试和改进我打算放弃这一方法，采用另一种稍有区别的方法。 第一个方法预测时以一个运单为一个样本，其实我们在计算ETA时，还观察到onboardDate，即离开起运港的时间并不是真实的出发时间，有的是出发后中间某一个时间，此外，这种方法要求第一个点尽量离起始港近一些。我的第二个方法就是把采样后每个运单最后一个时间点的数据作为预测样本，预测从这一点开始行驶到目的港所需的时间，打标方法为$label=timestamp_{max}-timestamp_{last}$，label以小时为单位，最后$ETA=timestamp_{last}+label$，这样第一个点是否在起始港、onboardDate是否为真实离港时间、运单什么时候出发就无关紧要了。 4.2 数据预处理第二个方法预处理步骤需要稍作调整，就是不需要考虑第一个点与起始港的距离，再就是对于两点之间距离超过船的行驶能力的数据点进行去除，之前我是按时间间隔大小为阈值进行去除的，但是这样明显不正确，需要考虑两点之间的距离和时间差。"},{"title":"Hello World","date":"2020-07-10T09:22:53.392Z","url":"/2020/07/10/hello-world/","content":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post More info: Writing Run server More info: Server Generate static files More info: Generating Deploy to remote sites More info: Deployment"}]